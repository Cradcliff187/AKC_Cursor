{% extends "base.html" %}
{% from 'components/forms.html' import form_group, address_form_group %}
{% from 'components/address.html' import address_scripts %}

{% block title %}{% if customer %}Edit{% else %}New{% endif %} Customer{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-white">
                    <h4 class="mb-0">{% if customer %}Edit{% else %}New{% endif %} Customer</h4>
                </div>
                <div class="card-body">
                    <form method="POST">
                        {{ form_group("Customer Name", "name", value=customer.name if customer else "", required=true) }}
                        
                        <div class="row">
                            <div class="col-md-6">
                                {{ form_group("Email", "email", type="email", value=customer.email if customer else "", required=true) }}
                            </div>
                            <div class="col-md-6">
                                {{ form_group("Phone", "phone", type="tel", value=customer.phone if customer else "", required=true) }}
                            </div>
                        </div>

                        <!-- Address Section -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Address Information</h5>
                            </div>
                            <div class="card-body">
                                {{ address_form_group(
                                    value={
                                        'street': customer.address if customer else '',
                                        'city': customer.city if customer else '',
                                        'state': customer.state if customer else '',
                                        'zip': customer.zip if customer else '',
                                        'latitude': customer.latitude if customer else '',
                                        'longitude': customer.longitude if customer else ''
                                    } if customer else {},
                                    required=true
                                ) }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                {{ form_group("Payment Terms", "payment_terms", value=customer.payment_terms if customer else "Net 30") }}
                            </div>
                            <div class="col-md-6">
                                {{ form_group("Credit Limit", "credit_limit", type="number", value=customer.credit_limit if customer else "5000.00") }}
                            </div>
                        </div>

                        {{ form_group("Notes", "notes", value=customer.notes if customer else "") }}

                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-1"></i> Save Customer
                            </button>
                            <a href="{{ url_for('customers.list') }}" class="btn btn-outline-secondary ms-2">
                                <i class="fas fa-times me-1"></i> Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ address_scripts(api_key=google_maps_api_key) }}
{% endblock %} 