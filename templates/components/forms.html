{% from 'components/address.html' import address_fields, address_display, address_scripts %}

{% macro form_group(label, name, type="text", value="", required=false, placeholder="", help_text=None) %}
<div class="form-group mb-3">
    <label for="{{ name }}" class="form-label">
        {{ label }}
        {% if required %}<span class="text-danger">*</span>{% endif %}
    </label>
    <input type="{{ type }}" 
           class="form-control" 
           id="{{ name }}" 
           name="{{ name }}" 
           value="{{ value }}"
           {% if required %}required{% endif %}
           placeholder="{{ placeholder }}"
    >
    {% if help_text %}
    <small class="form-text text-muted">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{% macro select_group(label, name, options, selected="", required=false, help_text=None) %}
<div class="form-group mb-3">
    <label for="{{ name }}" class="form-label">
        {{ label }}
        {% if required %}<span class="text-danger">*</span>{% endif %}
    </label>
    <select class="form-select" id="{{ name }}" name="{{ name }}" {% if required %}required{% endif %}>
        <option value="">Select {{ label.lower() }}...</option>
        {% for option in options %}
            <option value="{{ option.value }}" {% if option.value == selected %}selected{% endif %}>
                {{ option.label }}
            </option>
        {% endfor %}
    </select>
    {% if help_text %}
    <small class="form-text text-muted">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{% macro textarea_group(label, name, value="", rows=3, required=false, help_text=None) %}
<div class="form-group mb-3">
    <label for="{{ name }}" class="form-label">
        {{ label }}
        {% if required %}<span class="text-danger">*</span>{% endif %}
    </label>
    <textarea class="form-control" 
              id="{{ name }}" 
              name="{{ name }}" 
              rows="{{ rows }}"
              {% if required %}required{% endif %}
    >{{ value }}</textarea>
    {% if help_text %}
    <small class="form-text text-muted">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{% macro date_group(label, name, value="", required=false, min_date=None, max_date=None, help_text=None) %}
<div class="form-group mb-3">
    <label for="{{ name }}" class="form-label">
        {{ label }}
        {% if required %}<span class="text-danger">*</span>{% endif %}
    </label>
    <input type="date" 
           class="form-control" 
           id="{{ name }}" 
           name="{{ name }}" 
           value="{{ value }}"
           {% if required %}required{% endif %}
           {% if min_date %}min="{{ min_date }}"{% endif %}
           {% if max_date %}max="{{ max_date }}"{% endif %}
    >
    {% if help_text %}
    <small class="form-text text-muted">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{% macro form_actions(submit_text="Save", cancel_url=None, delete_action=None) %}
<div class="form-actions d-flex justify-content-between align-items-center mt-4">
    <div>
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-1"></i> {{ submit_text }}
        </button>
        {% if cancel_url %}
        <a href="{{ cancel_url }}" class="btn btn-outline-secondary ms-2">
            <i class="fas fa-times me-1"></i> Cancel
        </a>
        {% endif %}
    </div>
    {% if delete_action %}
    <div>
        <button type="button" 
                class="btn btn-outline-danger" 
                data-bs-toggle="modal" 
                data-bs-target="#deleteConfirmModal">
            <i class="fas fa-trash me-1"></i> Delete
        </button>
    </div>
    {% endif %}
</div>

{% if delete_action %}
<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this item? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form action="{{ delete_action }}" method="POST" class="d-inline">
                    <input type="hidden" name="_method" value="DELETE">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endmacro %}

{% macro file_upload(label, name, accept=None, multiple=false, required=false, help_text=None) %}
<div class="form-group mb-3">
    <label for="{{ name }}" class="form-label">
        {{ label }}
        {% if required %}<span class="text-danger">*</span>{% endif %}
    </label>
    <input type="file" 
           class="form-control" 
           id="{{ name }}" 
           name="{{ name }}"
           {% if accept %}accept="{{ accept }}"{% endif %}
           {% if multiple %}multiple{% endif %}
           {% if required %}required{% endif %}
    >
    {% if help_text %}
    <small class="form-text text-muted">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{% macro search_form(placeholder="Search...", value="", filters=None) %}
<form method="get" class="search-form mb-4">
    <div class="row g-2">
        <div class="col">
            <div class="input-group">
                <input type="text" 
                       class="form-control" 
                       name="search" 
                       placeholder="{{ placeholder }}"
                       value="{{ value }}">
                <button class="btn btn-outline-secondary" type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
        {% if filters %}
        <div class="col-auto">
            {{ filters }}
        </div>
        {% endif %}
    </div>
</form>
{% endmacro %}

{% macro address_form_group(prefix="", required=false, value={}, show_map=true) %}
<div class="form-group mb-4">
    {{ address_fields(prefix=prefix, required=required, value=value, show_map=show_map) }}
</div>
{% endmacro %} 